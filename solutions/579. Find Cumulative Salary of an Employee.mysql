SELECT
A.ID,A.MONTH,
(COALESCE(A.SALARY,0)+COALESCE(B.SALARY,0)+COALESCE(C.SALARY,0)) AS SALARY
FROM EMPLOYEE A
LEFT JOIN EMPLOYEE B
ON A.MONTH = B.MONTH + 1 AND A.ID=B.ID
LEFT JOIN EMPLOYEE C
ON B.MONTH = C.MONTH + 1 AND B.ID=C.ID
WHERE A.MONTH NOT IN (SELECT MAX(MONTH) FROM EMPLOYEE WHERE ID = A.ID)
ORDER BY A.ID,A.MONTH DESC
